% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build_exposure_network.R
\name{build_exposure_network}
\alias{build_exposure_network}
\title{Build an exposure-adjusted microbe-metabolite association network}
\usage{
build_exposure_network(
  X,
  Y,
  E,
  covar = NULL,
  fdr = 0.1,
  max_pairs = 5000,
  seed = NULL
)
}
\arguments{
\item{X}{Numeric matrix (samples x microbes).}

\item{Y}{Numeric matrix (samples x metabolites).}

\item{E}{Numeric matrix (samples x exposures).}

\item{covar}{Optional data.frame of sample-level covariates (rows = samples).}

\item{fdr}{FDR threshold for keeping edges (BH adjusted p-value).}

\item{max_pairs}{Max number of (microbe, metabolite) pairs to test (for speed).
If NULL, tests all pairs (may be slow).}

\item{seed}{Optional random seed used only when \code{max_pairs} is not NULL and
sampling is required. If \code{NULL}, the current RNG state is used.}
}
\value{
A list with:
\itemize{
\item edges: data.frame of significant edges (microbe, metabolite, weight, p_value, fdr)
\item graph: igraph object (bipartite)
\item meta: list of settings and counts
}
}
\description{
For each (microbe, metabolite) pair, fits a linear model:
\deqn{metabolite ~ microbe + exposures + covariates}
and uses the microbe coefficient as the edge weight.

This is an MVP, interpretable approach suitable for Bioconductor submission.
}
\examples{
set.seed(1)
d <- generate_dummy_exporisk(n = 30, p_micro = 10, p_metab = 12, p_expo = 4)
al <- align_omics(d$microbiome, d$metabolome, d$exposures, d$meta,
                 id_col = "sample_id", strict = TRUE)
pr <- prep_omics(al$microbiome, al$metabolome, al$exposures)
net <- build_exposure_network(pr$X, pr$Y, pr$E, fdr = 0.5, max_pairs = 120, seed = 1)
utils::head(net$edges)

}
