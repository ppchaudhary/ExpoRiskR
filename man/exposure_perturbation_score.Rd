% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/exposure_perturbation_score.R
\name{exposure_perturbation_score}
\alias{exposure_perturbation_score}
\title{Score exposures by network perturbation (leave-one-exposure-out)}
\usage{
exposure_perturbation_score(
  X,
  Y,
  E,
  covar = NULL,
  fdr = 0.2,
  max_pairs = 3000,
  seed = 1
)
}
\arguments{
\item{X}{Microbiome matrix (samples x microbes).}

\item{Y}{Metabolome matrix (samples x metabolites).}

\item{E}{Exposures matrix (samples x exposures).}

\item{covar}{Optional covariates data.frame.}

\item{fdr}{FDR threshold passed to build_exposure_network().}

\item{max_pairs}{Number of pairs to test per network build (speed control).}

\item{seed}{Random seed.}
}
\value{
A data.frame with exposure, perturbation_score, n_edges_ref, n_edges_drop.
}
\description{
Builds a reference network using all exposures, then for each exposure j builds
a network leaving out exposure j, and computes a perturbation score based on
differences in edge weights for a subset of tested pairs.

This is an MVP perturbation metric designed to be interpretable and fast enough
for simulated/demo datasets.
}
\examples{
set.seed(2)
d <- generate_dummy_exporisk(n = 30, p_micro = 10, p_metab = 12, p_expo = 4)
al <- align_omics(d$microbiome, d$metabolome, d$exposures, d$meta,
                 id_col = "sample_id", strict = TRUE)
pr <- prep_omics(al$microbiome, al$metabolome, al$exposures)
scores <- exposure_perturbation_score(pr$X, pr$Y, pr$E, fdr = 0.5, max_pairs = 120, seed = 1)
scores
}
